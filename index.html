<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>瓦力AI初号机</title>
    <link rel="stylesheet" href="styles.css?v=3.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="overlay"></div>
    <div class="menu-toggle">
        <i class="fas fa-bars"></i>
    </div>
    <div class="app-container">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <div class="sidebar-header">
                <img src="logo.svg" alt="Logo" class="logo">
                <h1>瓦力AI</h1>
            </div>
            <ul class="nav-links">
                <li><a href="#home" class="active"><i class="fas fa-home"></i>首页</a></li>
                <li><a href="#weather" class="weather-link"><i class="fas fa-cloud-sun"></i>柜me</a></li>
                <li><a href="#memoir" class="memoir-link"><i class="fas fa-book"></i>时绾</a></li>
                <li><a href="#photo" class="photo-link"><i class="fas fa-camera-retro"></i>云锦织机</a></li>
                <li><a href="#chat"><i class="fas fa-comments"></i>对话</a></li>
                <li><a href="#about"><i class="fas fa-info-circle"></i>关于</a></li>
            </ul>
        </div>

        <!-- 主内容区域 -->
        <div class="main-content">
            <!-- 首页 -->
            <div id="home" class="section active">
                <div class="hero">
                    <!-- 黑洞容器 -->
                    <div class="blackhole-container">
                        <div class="blackhole-core">
                            <!-- 吸积盘 -->
                            <div class="accretion-disk">
                                <div class="accretion-ring"></div>
                                <div class="accretion-ring"></div>
                                <div class="accretion-ring"></div>
                            </div>
                            <!-- 波纹线条 -->
                            <div class="wave-lines">
                                <div class="wave-line"></div>
                                <div class="wave-line"></div>
                                <div class="wave-line"></div>
                                <div class="wave-line"></div>
                                <div class="wave-line"></div>
                            </div>
                            <!-- 引力折射光环 -->
                            <div class="gravitational-lens"></div>
                            <!-- 睡觉表情 -->
                            <div class="sleeping-face">
                                <div class="eyes">
                                    <div class="eye-container">
                                        <div class="pupil"></div>
                                    </div>
                                    <div class="eye-container">
                                        <div class="pupil"></div>
                                    </div>
                                </div>
                                <div class="nose"></div>
                                <div class="cheeks">
                                    <div class="cheek"></div>
                                    <div class="cheek"></div>
                                </div>
                                <div class="zzz-container">
                                    <span class="zzz">z</span>
                                    <span class="zzz">z</span>
                                    <span class="zzz">z</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 文字内容 -->
                    <div class="text-content">
                        <h2 class="gradient-text">瓦力AI初号机</h2>
                        <p class="subtitle">你的智能生活管家</p>
                        <a href="#chat" class="cta-button">开始对话</a>
                    </div>
                </div>
            </div>

            <!-- 柜me天气模块 -->
            <section id="weather" class="section">
                <div class="weather-container">
                    <div class="weather-animation">
                        <!-- 天气动画将在这里 -->
                        <div class="walle-weather-character"></div>
                        <div class="weather-effects"></div>
                    </div>
                    <div class="weather-info">
                        <div class="current-weather">
                            <h3>今日天气</h3>
                            <div class="temperature"></div>
                            <div class="humidity"></div>
                        </div>
                        <div class="weather-forecast">
                            <h3>天气预报</h3>
                            <div class="forecast-list"></div>
                        </div>
                        <div class="clothing-advice">
                            <h3>穿衣建议</h3>
                            <div class="advice-content"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 时绾回忆录模块 -->
            <section id="memoir" class="section">
                <div class="memoir-container">
                    <div class="memoir-intro">
                        <h2>时光织造师</h2>
                        <p>让AI为您编织独特的人生回忆录</p>
                    </div>
                    <div class="memoir-interview">
                        <div class="interview-chat"></div>
                        <div class="interview-input">
                            <input type="text" placeholder="分享您的故事...">
                            <button class="send-story"><i class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>
                    <div class="memoir-preview">
                        <h3>您的回忆录</h3>
                        <div class="memoir-content"></div>
                        <div class="style-selector">
                            <button class="style-btn" data-style="poetic">诗意</button>
                            <button class="style-btn" data-style="narrative">叙事</button>
                            <button class="style-btn" data-style="emotional">感性</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 云锦织机照片处理模块 -->
            <section id="photo" class="section">
                <div class="photo-container">
                    <div class="photo-upload">
                        <div class="upload-area">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>点击或拖拽照片至此处</p>
                            <input type="file" accept="image/*" hidden>
                        </div>
                    </div>
                    <div class="photo-processing">
                        <div class="processing-options">
                            <button class="process-btn" data-type="restore">照片修复</button>
                            <button class="process-btn" data-type="animate">照片动画</button>
                        </div>
                        <div class="preview-area">
                            <div class="before-after">
                                <div class="before"></div>
                                <div class="after"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 对话部分 -->
            <section id="chat" class="section">
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="message wall-e">
                            <div class="message-content">
                                我是瓦力哔哔机（声卡版）
                            </div>
                        </div>
                        <!-- 消息列表将在这里动态添加 -->
                    </div>
                    <div class="chat-input">
                        <input type="text" id="user-input" placeholder="输入你的问题...">
                        <button id="send-button" class="send-button">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- 关于部分 -->
            <section id="about" class="section">
                <div class="about-container">
                    <div class="profile-grid">
                        <div class="profile-content">
                            <h2>关于我</h2>
                            <p>一个充满好奇心的AI助手，致力于为您提供最贴心的服务。</p>
                            <div class="social-links">
                                <a href="https://www.xiaohongshu.com/user/profile/664eb31b000000001b018a3a" class="social-icon" target="_blank">
                                    <i class="fas fa-book"></i> 小红书
                                </a>
                                <a href="https://space.bilibili.com/18368535" class="social-icon" target="_blank">
                                    <i class="fas fa-play-circle"></i> B站
                                </a>
                                <a href="https://v.douyin.com/US8BiUV4K64/" class="social-icon" target="_blank">
                                    <i class="fas fa-video"></i> 抖音
                                </a>
                            </div>
                        </div>
                        <div class="profile-image">
                            <img src="profile.jpg" alt="WALL-E">
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- 添加JavaScript -->
    <script>
        // 获取DOM元素
        const blackholeContainer = document.querySelector('.blackhole-container');
        const eyes = document.querySelector('.eyes');
        const ctaButton = document.querySelector('.cta-button');
        const pupils = document.querySelectorAll('.pupil');
        const menuToggle = document.querySelector('.menu-toggle');
        const sidebar = document.querySelector('.sidebar');
        const overlay = document.querySelector('.overlay');
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');

        // 状态变量
        let touchStartTime = 0;
        let touchCount = 0;
        let touchTimeout = null;
        let resetTimeout = null;
        let isAngry = false;
        let lastTouchTime = 0;

        // 重置状态
        function resetState() {
            blackholeContainer.classList.remove('awake', 'happy', 'angry');
            touchCount = 0;
            isAngry = false;
            clearTimeout(touchTimeout);
            clearTimeout(resetTimeout);
        }

        // 处理触摸/点击开始
        function handleTouchStart(event) {
            if (isAngry) return; // 如果正在生气，忽略触摸

            touchStartTime = Date.now();
            const currentTime = Date.now();
            
            // 检测快速点击
            if (currentTime - lastTouchTime < 300) {
                touchCount++;
                if (touchCount > 3) {
                    // 变成生气状态
                    isAngry = true;
                    blackholeContainer.classList.add('angry');
                    setTimeout(() => {
                        resetState();
                    }, 10000);
                    return;
                }
            } else {
                touchCount = 1;
            }
            
            lastTouchTime = currentTime;
            
            // 清除之前的定时器
            clearTimeout(touchTimeout);
            clearTimeout(resetTimeout);
            
            // 唤醒黑洞
            blackholeContainer.classList.add('awake');
            
            // 设置自动重置定时器
            resetTimeout = setTimeout(() => {
                resetState();
            }, 10000);
        }

        // 处理触摸/点击结束
        function handleTouchEnd() {
            if (isAngry) return;

            const touchDuration = Date.now() - touchStartTime;
            
            // 如果触摸时间超过5秒
            if (touchDuration > 5000) {
                resetState();
                return;
            }
            
            // 设置触摸超时
            touchTimeout = setTimeout(() => {
                if (!isAngry) {
                    blackholeContainer.classList.add('happy');
                }
            }, 500);
        }

        // 处理鼠标移动
        function handleMouseMove(event) {
            if (!blackholeContainer.classList.contains('awake') || isAngry) return;

            const rect = blackholeContainer.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            pupils.forEach(pupil => {
                const eyeRect = pupil.parentElement.getBoundingClientRect();
                const eyeCenterX = eyeRect.left + eyeRect.width / 2;
                const eyeCenterY = eyeRect.top + eyeRect.height / 2;
                
                const angle = Math.atan2(event.clientY - eyeCenterY, event.clientX - eyeCenterX);
                const distance = Math.min(8, Math.sqrt(Math.pow(event.clientX - eyeCenterX, 2) + Math.pow(event.clientY - eyeCenterY, 2)) / 15);
                
                const eyeX = Math.cos(angle) * distance;
                const eyeY = Math.sin(angle) * distance;
                
                pupil.style.transform = `translate(calc(-50% + ${eyeX}px), calc(-50% + ${eyeY}px))`;
            });
        }

        // 移动设备菜单处理
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        });

        overlay.addEventListener('click', () => {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        });

        // 在切换页面时关闭侧边栏
        function switchToPage(pageId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            document.querySelector(pageId).classList.add('active');
            document.querySelector(`.nav-links a[href="${pageId}"]`).classList.add('active');
            
            // 关闭侧边栏
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
            
            resetState();
        }

        // 添加事件监听器
        blackholeContainer.addEventListener('mousedown', handleTouchStart);
        blackholeContainer.addEventListener('touchstart', handleTouchStart);
        blackholeContainer.addEventListener('mouseup', handleTouchEnd);
        blackholeContainer.addEventListener('touchend', handleTouchEnd);
        document.addEventListener('mousemove', handleMouseMove);
        
        ctaButton.addEventListener('click', (event) => {
            handleTouchStart(event);
            setTimeout(() => {
                switchToPage('#chat');
            }, 2000);
        });

        // 添加导航链接点击处理
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href');
                switchToPage(targetId);
            });
        });

        // 天气功能相关代码
        async function getLocation() {
            try {
                const response = await fetch('https://api.ipapi.com/api/check?access_key=2fc47227ca87d54d3922f141649837f4');
                const data = await response.json();
                return {
                    city: data.city,
                    latitude: data.latitude,
                    longitude: data.longitude
                };
            } catch (error) {
                console.error('获取位置信息失败:', error);
                return null;
            }
        }

        async function getWeather(lat, lon) {
            try {
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=e7912f1a0e0b0097453f01b2ae4842e6&units=metric&lang=zh_cn`);
                const data = await response.json();
                return {
                    temp: Math.round(data.main.temp),
                    humidity: data.main.humidity,
                    weather: data.weather[0].main,
                    description: data.weather[0].description
                };
            } catch (error) {
                console.error('获取天气信息失败:', error);
                return null;
            }
        }

        function generateWeatherAnimation(weatherData) {
            const animationContainer = document.querySelector('.weather-animation');
            const walleCharacter = document.querySelector('.walle-weather-character');
            const effects = document.querySelector('.weather-effects');
            
            // 清除现有动画
            effects.innerHTML = '';
            
            // 创建瓦力天气形象
            walleCharacter.innerHTML = `
                <div class="weather-walle">
                    <div class="weather-blackhole">
                        <div class="weather-core"></div>
                        <div class="weather-eyes">
                            <div class="weather-eye"></div>
                            <div class="weather-eye"></div>
                        </div>
                    </div>
                </div>
            `;
            
            // 根据天气类型添加效果
            switch(weatherData.weather.toLowerCase()) {
                case 'rain':
                    effects.innerHTML = generateRainEffect();
                    break;
                case 'snow':
                    effects.innerHTML = generateSnowEffect();
                    break;
                case 'clouds':
                    effects.innerHTML = generateCloudEffect();
                    break;
                case 'clear':
                    effects.innerHTML = generateSunEffect();
                    break;
                // 添加更多天气类型...
            }
            
            // 更新温度和湿度显示
            document.querySelector('.temperature').textContent = `${weatherData.temp}°C`;
            document.querySelector('.humidity').textContent = `湿度: ${weatherData.humidity}%`;
            
            // 生成穿衣建议
            generateClothingAdvice(weatherData.temp);
        }

        function generateRainEffect() {
            return `
                <div class="rain-container">
                    ${Array(20).fill().map(() => '<div class="raindrop"></div>').join('')}
                </div>
            `;
        }

        function generateSnowEffect() {
            return `
                <div class="snow-container">
                    ${Array(20).fill().map(() => '<div class="snowflake"></div>').join('')}
                </div>
            `;
        }

        function generateCloudEffect() {
            return `
                <div class="cloud-container">
                    <div class="cloud"></div>
                    <div class="cloud"></div>
                </div>
            `;
        }

        function generateSunEffect() {
            return `
                <div class="sun-container">
                    <div class="sun"></div>
                    <div class="sun-rays"></div>
                </div>
            `;
        }

        function generateClothingAdvice(temperature) {
            const adviceElement = document.querySelector('.advice-content');
            let advice = '';
            
            if (temperature <= 5) {
                advice = '建议穿羽绒服、围巾、帽子等保暖衣物';
            } else if (temperature <= 15) {
                advice = '建议穿厚外套、毛衣等保暖装扮';
            } else if (temperature <= 25) {
                advice = '建议穿薄外套或长袖衬衫';
            } else {
                advice = '建议穿轻薄、透气的夏季服装';
            }
            
            adviceElement.textContent = advice;
        }

        // 页面加载时自动初始化天气功能
        window.addEventListener('DOMContentLoaded', async () => {
            const location = await getLocation();
            if (location) {
                const weather = await getWeather(location.latitude, location.longitude);
                if (weather) {
                    generateWeatherAnimation(weather);
                }
            }
        });

        // 每30分钟更新一次天气信息
        setInterval(async () => {
            const location = await getLocation();
            if (location) {
                const weather = await getWeather(location.latitude, location.longitude);
                if (weather) {
                    generateWeatherAnimation(weather);
                }
            }
        }, 30 * 60 * 1000);

        // 发送消息
        function sendMessage() {
            const content = userInput.value.trim();
            if (!content) return;

            // 添加用户消息
            addMessage(content, 'user');
            userInput.value = '';

            // 模拟AI回复
            setTimeout(() => {
                const responses = [
                    '我明白了，让我想想...',
                    '这是一个很有趣的问题！',
                    '我可以帮你解决这个问题。',
                    '让我为你详细解释一下。'
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addMessage(randomResponse, 'wall-e');
            }, 1000);
        }

        // 添加消息到聊天框
        function addMessage(content, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `
                <div class="message-content">
                    ${content}
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // 添加事件监听器
        sendButton.addEventListener('click', sendMessage);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html> 